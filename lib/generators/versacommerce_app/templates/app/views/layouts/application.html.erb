<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../assets/favicon.png">
    <link rel="apple-touch-icon" href="../assets/versacommerce-57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../assets/versacommerce-72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../assets/versacommerce-114.png">

    <title>VersaCommerce Sample App</title>

    <!-- Bootstrap core CSS -->
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">

    <%= stylesheet_link_tag 'application' %>

    <style type="text/css" media="screen">
      /* Sticky footer styles
      -------------------------------------------------- */

      html,
      body {
        height: 100%;
        /* The html and body elements cannot have any padding or margin. */
      }

      /* Wrapper for page content to push down footer */
      #wrap {
        min-height: 100%;
        height: auto !important;
        height: 100%;
        /* Negative indent footer by its height */
        margin: 0 auto -60px;
        /* Pad bottom by footer height */
        padding: 0 0 60px;
      }

      /* Set the fixed height of the footer here */
      #footer {
        height: 60px;
        background-color: #f5f5f5;
      }


      /* Custom page CSS
      -------------------------------------------------- */

      #wrap > .container {
        padding: 60px 15px 0;
      }
      .container .credit {
        margin: 20px 0;
      }

      #footer > .container {
        padding-left: 15px;
        padding-right: 15px;
      }

      code {
        font-size: 80%;
      }

      .dropdown-menu>li>a.switch-shop-current {
        font-weight: bold;
        cursor: default;
      }
    </style>

    <script type="text/javascript">

      $(function() {
        return $('a.switch-shop').on('click', function(e) {
          var shop_url;
          e.preventDefault();
          shop_url = $(e.target).prop('rel');
          if (shop_url) {
            return window.location = '/login/?shop=' + shop_name;
          }
        });
      });

    </script>


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
      <!-- <script src="../../assets/js/respond.min.js"></script> -->
    <![endif]-->
    <%= csrf_meta_tags %>
  </head>

  <body>

    <!-- Wrap all page content here -->
    <div id="wrap">
      <!-- Fixed navbar -->
      <div class="navbar navbar-default navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <%= link_to 'VersaCommerce App', '/', :class => 'navbar-brand' %>
          </div>
          <% if current_shop %>
          <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
              <li><a href="https://github.com/versacommerce/vc-api" target="_blank">API Documentation</a></li>
              <li><a href="https://github.com/versacommerce/versacommerce_api" target="_blank">API GEM</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= current_shop.url %> <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><%= link_to raw('<i class="icon-home"></i> Shop'), "http://"+current_shop.url, :target => 'blank' %></li>
                  <li><%= link_to raw('<i class="icon-cog"></i> Admin'), "http://"+current_shop.url+"/admin", :target => 'blank' %></li>
                  <li class="divider"></li>
                  <li><%= link_to raw('<i class="icon-off"></i> Logout'), logout_path, :method => :delete %></li>
                </ul>
              </li>
            </ul>

            <!-- switch between shops, change event handled by js -->
            <%- unless @installed_shops.empty? %>
            <ul class="nav navbar-nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= t('sessions.views.switch_shop') %> <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <%- @installed_shops.each do |shop| %>
                    <li><%= link_to shop.split('.').first.titleize, 'javascript:void(0);', class: (current_shop.url == shop ? 'switch-shop-current' : 'switch-shop'), rel: (current_shop.url == shop ? nil : shop)%></li>
                  <%- end %>
                  <li><%= link_to t('layout.add_new_shop'), login_path %></li>
                </ul>
              </li>
            </ul>
            <%- end %>
            <!-- end of shops switch -->

          </div><!--/.nav-collapse -->
          <% end %>
        </div>
      </div>

      <!-- Begin page content -->
      <div class="container">
        <% flash.each do |type, message| %>
          <div class="alert alert-<%= type %>"><%= message %></div>
        <% end %>
        <%= yield %>
      </div>
    </div>

    <div id="footer">
      <div class="container">
        <p class="text-muted credit">VersaCommerce Example App. Created by <a href="http://www.versacommerce.de" target="_blank">versacommerce.de</a></p>
      </div>
    </div>

    <%= javascript_include_tag 'application' %>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
  </body>
</html>
